<!doctype html>
<html lang="es">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>  asynccontextmanager – Novedades en python3.7 | David Francos
</title>
  <link rel="canonical" href="./asynccontextmanager.html">
  <link href="https://fonts.googleapis.com/css?family=Advent+Pro" rel="stylesheet">


    <link rel="apple-touch-icon" href="./apple-touch-icon.png" sizes="180x180">
    <link rel="icon" type="image/png" href="./favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="./favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="./manifest.json">
    <meta name="theme-color" content="#333333">

  <link href="https://fonts.googleapis.com/css?family=Advent+Pro|Roboto" rel="stylesheet">
  <link rel="stylesheet" href="./theme/css/bootstrap.min.css">
  <link rel="stylesheet" href="./theme/css/font-awesome.min.css">
  <link rel="stylesheet" href="./theme/css/pygments/vim.min.css">
  <link rel="stylesheet" href="./theme/css/theme.css">


  
  <meta name="description" content="Con la salida de python3.7, disponemos del nuevo decorador asynccontextmanager en contextlib.">
  <script>
    (function(i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function() {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o);
      a.async = 1;
      a.src = g;
      m = s.getElementsByTagName(o)[0];
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-53006258-1', 'auto');
    ga('send', 'pageview');
  </script>


</head>

<body>
  <header class="header">
<div class="container" style="max-width:100%; margin-top:30px">
<div class="row align-items-center justify-content-center">
  <div class="col-sm-4 text-center">
    <a href="./" class=brand>
      <img class="img img-responsive text-center" src=./theme/images/logo.png alt="David Francos">
    </a>
  </div>
</div>
<div class="row align-items-center justify-content-center">
  <div class="col-sm-12 text-center">
      <p class="text-muted">Tecnología y patitos de goma</p>
    <ul id="menu-menu-1" class="list-inline menu">
      <li class="list-inline-item"><a href="/">Inicio</a></li>
        <li class="list-inline-item"><a href="/category/python.html">Python</a></li>
        <li class="list-inline-item"><a href="/category/tecnologia.html">Tecnologia</a></li>
      <li class="list-inline-item"><a href="/pages/acerca-de.html">Acerca de David Francos</a></li>
      <li class="list-inline-item"><a href="/pages/contacto.html">Contacto</a></li>
    </ul>
   </div>
</div>
</div>  </header>

  <div class="main">
    <div class="container">
      <h1>  asynccontextmanager – Novedades en python3.7
</h1>
  <article class="article">
    <div class="content">
      <p>La semana pasada vio la luz python3.7, todavía está en version alpha0, pero ya
podemos encontrar una lista de cambios interesantes. El cambio que
probablemente vaya a estar más presente en desarrollos futuros es el decorador
<em>“@contextlib.asynccontextmanager”</em>, este articulo actua a modo de pequeña
introducción al mismo.</p>
<p>El concepto de <em>@asynccontextmanager</em> es el mismo que @ontextmanager, una forma
rápida de definir objetos que son manejadores de contexto, sin necesidad de
implementar una clase con los métodos mágicos <em>__enter__</em> y <em>__exit__</em>. Para ello
se aprovecha de los generadores asíncronos, una funcionalidad introducida en
<em>python3.7a0</em>, por lo que ya es familiar para muchos dado que <em>python3.6</em> lleva
tiempo siendo la versión estable.</p>
<p>La documentación del modelo de datos de Python establece un manejador de
contexto como un objeto que define el contexto de ejecución que será
establecido cuando ejecutemos una sentencia <em>“with”</em>. El manejador de contexto se
encarga de <strong>gestionar la entrada y la salida del contexto de ejecución del
bloque de código</strong>.</p>
<p>Esto es, dado un bloque de código, el manejador de contexto ejecuta código
antes y después del mismo. A modo de "preparación-ejecución-limpieza".</p>
<img alt="Async context manager example" class="img-fluid" src="/images/asynccontextmanager.png"/>
<div class="line-block">
<div class="line"><br/></div>
</div>
<p>En el ejemplo podemos ver que la variable “a” tenia el valor “foo” al inicio
del bloque de código, y al final del mismo tenía el valor “bar”. A su vez
podemos ver que han pasado 10s, que hemos esperado con asyncio.sleep.</p>
<p>Dado que esta funcionalidad sólo esta disponible en python3.7, y este no está
empaquetado todavía, es necesario compilarlo desde el fuente si queremos
probarla.</p>
<p>Es posible hacer el build-dep con python3 en una versión inferior a 3.5, sin
embargo necesitaremos instalar a mano la librería openssl-dev. En debian
podemos hacerlo rápidamente como se puede ver a continuación:</p>
<div class="highlight"><pre><span></span>sudo apt-get build-dep python3.5
git clone https://github.com/python/cpython
<span class="nb">cd</span> cpython
sh configure <span class="o">&amp;&amp;</span> make
sudo make install
</pre></div>

    </div>
  </article>
  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function() {
      // this.page.url = 'davidfrancos.net/asynccontextmanager.html';
      this.page.identifier = 'asynccontextmanager';
    };
    (function() {
      var d = document;
      var s = d.createElement('script');
      s.src = '//david-francos.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript class="text-muted">
    Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
  </noscript>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
<footer class="content-info">
  <div class=container style="text-align:center; margin-bottom:20px; padding-top:10px">
     <a style="margin-right:40px" target=_blank rel="noreferrer"  href="http://linkedin.com/in/davidfrancos/"><i style="font-size:4em;" title="linkedin" class="fa fa-linkedin" aria-hidden="true"></i></a>
     <a style="margin-right:40px" target=_blank  rel="noreferrer" href="http://github.com/xayon/"><i style="font-size:4em;" class="fa fa-github" title="github" aria-hidden="true"></i></a>
     <a  target=_blank title="gratipay"  rel="noreferrer" href="https://gratipay.com/~XayOn/"><i style="font-size:4em;" class="fa fa-gratipay" aria-hidden="true"></i></a>
     <!-- Begin Mailchimp Signup Form -->
     <br/>
     <link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css">
     <style type="text/css">
     	#mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; width:100%;}
     </style>
     <div id="mc_embed_signup">
     <form action="https://davidfrancos.us20.list-manage.com/subscribe/post?u=2b9d1c0b5a4774f3f5af56a15&amp;id=c6f9c1b981" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
         <div id="mc_embed_signup_scroll">

     	<input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
         <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
         <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_2b9d1c0b5a4774f3f5af56a15_c6f9c1b981" tabindex="-1" value=""></div>
         <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
         </div>
     </form>
     </div>
  </div>
</footer>    </div>
  </footer>
</body>

</html>